uuid: 34c3a0e7-6b9d-5e50-1c4d-3f8a1b1e5d7c
api_version: '2.0'
name: Credential Stuffing
description: Use compromised credentials from previous breaches to gain macOS access
platform: darwin
category: initial_access
tactics:
  - valid_accounts
techniques:
  - T1078
severity: medium
author: Claude Code
created: 2026-01-30

args:
  target_account:
    description: Target account name to test credentials against
    type: string
    required: true
  password_list:
    description: Path to password list for stuffing attempt
    type: string
    required: true
  leaked_creds_file:
    description: Path to file with leaked credentials from previous breaches
    type: string
    required: true
  oauth_token:
    description: OAuth token for API authentication
    type: string
    required: false

steps:
  - name: load_leaked_credentials
    description: Load previously leaked credentials from breach databases
    command: |
      echo "Loading leaked credentials from: ${leaked_creds_file}"
      if [ -f "${leaked_creds_file}" ]; then
        wc -l < "${leaked_creds_file}" | xargs echo "Leaked credentials loaded:"
      fi
      
  - name: extract_password_variants
    description: Extract password variants that might apply to target
    command: |
      echo "Extracting password variants for: ${target_account}"
      if [ -f "${leaked_creds_file}" ]; then
        # Dry run: simulate extraction
        echo "Analyzing credential patterns"
      fi
      
  - name: attempt_credential_stuffing
    description: Attempt authentication using leaked credentials
    command: |
      echo "Attempting credential stuffing against: ${target_account}"
      if [ -f "${leaked_creds_file}" ]; then
        count=0
        while IFS= read -r cred; do
          count=$((count + 1))
          # Dry run: simulate attempt
          [ $((count % 50)) -eq 0 ] && echo "Tested ${count} credentials"
        done < "${leaked_creds_file}"
        echo "Completed stuffing with ${count} credentials"
      fi
      
  - name: validate_successful_access
    description: Validate if credential stuffing resulted in access
    command: |
      echo "Validating access results"
      # Dry run simulation
      exit 0

checks:
  - name: verify_access_gained
    description: Verify successful account access
    command: |
      echo "Verifying stuffing success"
      exit 0

tests:
  dry_run: true
  simulate_only: true

cleanup:
  - name: revoke_tokens
    description: Revoke any obtained OAuth tokens
    command: |
      echo "Revoking obtained tokens"
      
  - name: reset_passwords
    description: Reset compromised account passwords
    command: |
      echo "Resetting account passwords"
