name: "011: Exploit public-facing application"
description: "Exploit known vulnerabilities in public-facing web applications to achieve initial access"
id: "d4e7a9f2-8c1b-4a6f-9d2e-5b3c8a1f6e7d"
api_version: "2.0"
platform: darwin
tags:
  - initial_access
  - web_exploitation
  - public_facing_app
  - cve_exploitation
actors: []
mitre_attack:
  tactics:
    - initial_access
  techniques:
    - T1190
procedure_examples: []
arguments:
  target_url:
    description: "Target web application URL"
    type: string
    required: true
    default: "http://vulnerable-app.local"
  vulnerability_type:
    description: "Type of vulnerability to exploit (cve, unpatched, known_weakness)"
    type: string
    required: true
    default: "known_weakness"
  payload_path:
    description: "Path to exploit payload file"
    type: string
    required: true
    default: "/tmp/exploit_payload.txt"
  exploit_code:
    description: "Exploit code or command to execute"
    type: string
    required: true
    default: "curl -X GET 'http://vulnerable-app.local/admin?bypass=true'"
steps:
  - name: "Reconnaissance"
    description: "Gather information about the target application"
    command: |
      echo "[*] Performing reconnaissance on target: ${target_url}"
      curl -s -I "${target_url}" | head -20
      curl -s "${target_url}" | grep -i "server\|powered by\|x-powered" | head -5
  - name: "Identify vulnerability"
    description: "Identify exploitable vulnerability in the application"
    command: |
      echo "[*] Identifying ${vulnerability_type} vulnerabilities"
      cat "${payload_path}" 2>/dev/null || echo "[!] No payload file found at ${payload_path}"
  - name: "Execute exploit"
    description: "Execute the exploit code against the target"
    command: |
      echo "[*] Executing exploit: ${exploit_code}"
      eval "${exploit_code}" 2>&1 || echo "[!] Exploit execution failed"
  - name: "Verify access"
    description: "Verify that the exploit was successful"
    command: |
      echo "[*] Verifying exploit success"
      curl -s "${target_url}/admin" | grep -q "authenticated\|dashboard" && echo "[+] Access verified" || echo "[-] Access verification failed"
checks:
  - name: "Payload execution check"
    description: "Verify that the payload was executed on target"
    command: "curl -s '${target_url}/status' | grep -q 'active\\|running' && echo 'PASS' || echo 'FAIL'"
  - name: "Response code check"
    description: "Verify successful HTTP response code"
    command: "curl -s -o /dev/null -w '%{http_code}' '${target_url}' | grep -q '200\\|302\\|401' && echo 'PASS' || echo 'FAIL'"
tests:
  - name: "exploit_execution_test"
    description: "Test exploit execution in dry run mode"
    dry_run: true
    command: |
      echo "[TEST] Simulating exploit execution"
      echo "[TEST] Target: ${target_url}"
      echo "[TEST] Payload: $(basename ${payload_path})"
      echo "[TEST] Would execute: ${exploit_code}"
cleanup:
  - name: "Remove exploit artifacts"
    description: "Clean up any shell scripts, payloads, or temporary files"
    command: |
      echo "[*] Cleaning up exploit artifacts"
      rm -f "${payload_path}" 2>/dev/null
      rm -f /tmp/shell_* 2>/dev/null
      rm -f /tmp/web_shell_* 2>/dev/null
      echo "[+] Cleanup complete"
