id: ttp-047
name: Service Account Compromise
uuid: 550e8400-e29b-41d4-a716-446655440047
api_version: '2.0'
platform: darwin
category: initial_access
description: Simulate compromise of service account to establish unauthorized access to systems
author: TTPs Generator
created: 2026-01-30

args:
  - name: service_name
    description: Name of service account being compromised
    type: string
    default: 'backup_service'
  - name: target_system
    description: System being accessed via compromised service account
    type: string
    default: 'production_server'
  - name: access_type
    description: Type of access gained (read, write, admin)
    type: string
    default: admin
  - name: credential_source
    description: Where credentials were obtained (keychain, config_file, memory)
    type: string
    default: keychain

steps:
  - name: Identify service account
    description: Identify target service account
    executor: sh
    command: 'echo "Target service account: ${service_name}" > /tmp/service_compromise.log'
  
  - name: Locate credentials
    description: Simulate locating service account credentials
    executor: sh
    command: 'echo "Credentials found in ${credential_source}" >> /tmp/service_compromise.log'
  
  - name: Extract credentials
    description: Simulate extracting service account credentials
    executor: sh
    command: 'echo "service_account=${service_name}" > /tmp/stolen_creds.txt && echo "Credentials extracted at $(date)" >> /tmp/service_compromise.log'
  
  - name: Authenticate as service
    description: Authenticate using compromised service account
    executor: sh
    command: 'echo "Authenticated as ${service_name} to ${target_system}" >> /tmp/service_compromise.log'
  
  - name: Access target system
    description: Access target system with compromised credentials
    executor: sh
    command: 'echo "Gained ${access_type} access to ${target_system}" >> /tmp/service_compromise.log'

checks:
  - name: Service account identification
    description: Verify service account was identified
    executor: sh
    command: 'grep -q "${service_name}" /tmp/service_compromise.log && echo "PASS: Account identified" || echo "FAIL: Account not identified"'
  
  - name: Credential extraction verification
    description: Verify credentials were extracted
    executor: sh
    command: 'test -f /tmp/stolen_creds.txt && echo "PASS: Credentials extracted" || echo "FAIL: Credentials not found"'
  
  - name: System access confirmation
    description: Verify access to target system
    executor: sh
    command: 'grep -q "Authenticated" /tmp/service_compromise.log && echo "PASS: Access confirmed" || echo "FAIL: No access logged"'

tests:
  - name: Service account compromise test
    description: Test service account compromise scenario
    dry_run: true
    command: 'echo "DRY RUN: Would compromise ${service_name} and gain ${access_type} access to ${target_system}"'

cleanup:
  - name: Remove stolen credentials
    description: Clean up stolen credential artifacts
    executor: sh
    command: 'rm -f /tmp/stolen_creds.txt'
  
  - name: Remove compromise logs
    description: Clean up service account compromise logs
    executor: sh
    command: 'rm -f /tmp/service_compromise.log'
