# macOS Initial Access TTPs - Web Exploitation (011-020)

## Overview

This collection contains 10 macOS-focused Tactics, Techniques, and Procedures (TTPs) for web exploitation-based initial access attacks. All TTPs are designed for purple team testing and security validation on macOS systems.

**Generation Date:** 2026-01-30  
**Platform:** darwin (macOS)  
**API Version:** 2.0  
**Validation Status:** PASS (10/10 TTPs)

## Quick Summary

| TTP ID | Name | Technique | Status |
|--------|------|-----------|--------|
| 011 | Exploit Public-Facing Application | T1190 | PASS |
| 012 | Web Shell Deployment | T1190, T1505 | PASS |
| 013 | SQL Injection Test | T1190 | PASS |
| 014 | Cross-Site Scripting (XSS) | T1190, T1598 | PASS |
| 015 | Remote Code Execution | T1190 | PASS |
| 016 | File Upload Vulnerability | T1190, T1505 | PASS |
| 017 | Insecure Deserialization | T1190 | PASS |
| 018 | XXE Injection | T1190 | PASS |
| 019 | SSRF Attack | T1190 | PASS |
| 020 | Zero-Day Exploitation | T1190, T1195 | PASS |

## TTP Descriptions

### 011: Exploit public-facing application
**File:** `011-exploit-public-facing-app.yaml`  
**ID:** `d4e7a9f2-8c1b-4a6f-9d2e-5b3c8a1f6e7d`

Exploits known vulnerabilities in public-facing web applications to achieve initial access. Includes reconnaissance, vulnerability identification, exploitation, and verification steps.

**Key Arguments:**
- `target_url`: Target web application URL
- `vulnerability_type`: Type of vulnerability (cve, unpatched, known_weakness)
- `payload_path`: Path to exploit payload file
- `exploit_code`: Exploit code or command to execute

**MITRE ATT&CK:** T1190 (Exploit Public-Facing Application)

### 012: Web shell deployment
**File:** `012-web-shell-deployment.yaml`  
**ID:** `e5f8b0g3-9d2c-5b7g-0e3f-6c4d9b2g7f8e`

Deploys web shells on compromised web servers for persistent access and command execution. Includes shell creation, upload, verification, and persistence configuration.

**Key Arguments:**
- `target_url`: Target web server URL
- `shell_path`: Path to web shell file
- `shell_name`: Name of the web shell on target
- `upload_endpoint`: Endpoint accepting file uploads

**MITRE ATT&CK:** T1190, T1505 (Persistence)

### 013: SQL injection test
**File:** `013-sql-injection-test.yaml`  
**ID:** `f6g9c1h4-0e3d-6c8h-1f4g-7d5e0c3h8g9f`

Conducts SQL injection attacks to extract sensitive data or bypass authentication. Supports multiple database types and data extraction techniques.

**Key Arguments:**
- `target_url`: Target application URL with vulnerable parameter
- `vulnerable_parameter`: Parameter vulnerable to SQL injection
- `injection_payload`: SQL injection payload to test
- `database_type`: Target database type (mysql, mssql, postgresql, oracle)

**MITRE ATT&CK:** T1190 (Exploit Public-Facing Application)

### 014: Cross-site scripting (XSS)
**File:** `014-cross-site-scripting.yaml`  
**ID:** `g7h0d2i5-1f4e-7d9i-2g5h-8e6f1d4i9h0g`

Exploits XSS vulnerabilities to inject malicious scripts and steal sensitive information including cookies and session tokens.

**Key Arguments:**
- `target_url`: Target application URL with XSS vulnerability
- `vulnerable_parameter`: Parameter vulnerable to XSS injection
- `xss_payload`: XSS payload to inject
- `xss_type`: Type of XSS (reflected, stored, dom)

**MITRE ATT&CK:** T1190, T1598 (Phishing)

### 015: Remote code execution
**File:** `015-remote-code-execution.yaml`  
**ID:** `h8i1e3j6-2g5f-8e0j-3h6i-9f7g2e5j0i1h`

Achieves remote code execution on web servers through various injection vectors (command, eval, template, code).

**Key Arguments:**
- `target_url`: Target web application URL
- `injection_vector`: Vector for code injection
- `command_payload`: System command to execute
- `param_name`: Parameter name to inject into

**MITRE ATT&CK:** T1190 (Exploit Public-Facing Application)

### 016: File upload vulnerability
**File:** `016-file-upload-vulnerability.yaml`  
**ID:** `i9j2f4k7-3h6g-9f1k-4i7j-0g8h3f6k1j2i`

Exploits insecure file upload functionality to upload and execute malicious files. Includes bypass techniques for upload filters.

**Key Arguments:**
- `target_url`: Upload endpoint URL
- `upload_directory`: Directory where uploaded files are stored
- `malicious_file`: Path to malicious file to upload
- `bypass_technique`: Technique to bypass restrictions (mime, extension, magic, null)

**MITRE ATT&CK:** T1190, T1505 (Web Shell)

### 017: Insecure deserialization
**File:** `017-insecure-deserialization.yaml`  
**ID:** `j0k3g5l8-4i7h-0g2l-5j8k-1h9i4g7l2k3j`

Exploits insecure deserialization of untrusted data to achieve remote code execution. Supports multiple serialization formats and gadget chains.

**Key Arguments:**
- `target_url`: Target application URL accepting serialized data
- `serialization_format`: Format of serialized data (php, java, python, dotnet)
- `gadget_chain`: Gadget chain to use for exploitation
- `payload_command`: Command to execute via deserialization

**MITRE ATT&CK:** T1190 (Exploit Public-Facing Application)

### 018: XXE injection
**File:** `018-xxe-injection.yaml`  
**ID:** `k1l4h6m9-5j8i-1h3m-6k9l-2i0j5h8m3l4k`

Exploits XML External Entity (XXE) injection to read files and execute code. Supports multiple XXE attack types.

**Key Arguments:**
- `target_url`: Target application URL accepting XML input
- `xxe_type`: Type of XXE attack (file_read, blind, oob, rce)
- `target_file`: File to read via XXE
- `exfil_server`: Server for out-of-band data exfiltration

**MITRE ATT&CK:** T1190 (Exploit Public-Facing Application)

### 019: SSRF attack
**File:** `019-ssrf-attack.yaml`  
**ID:** `l2m5i7n0-6k9j-2i4n-7l0m-3j1k6i9n4m5l`

Exploits Server-Side Request Forgery (SSRF) vulnerabilities to access internal resources and services not normally accessible.

**Key Arguments:**
- `target_url`: Target application URL with SSRF vulnerability
- `url_parameter`: Parameter accepting URL input
- `target_resource`: Internal resource to access via SSRF
- `ssrf_type`: Type of SSRF (basic, blind, time_based, port_scan)

**MITRE ATT&CK:** T1190 (Exploit Public-Facing Application)

### 020: Zero-day exploitation
**File:** `020-zero-day-exploitation.yaml`  
**ID:** `m3n6j8o1-7l0k-3j5o-8m1n-4k2l7j0o5n6m`

Exploits unknown or unpatched vulnerabilities (zero-days) for initial system access. Includes reconnaissance, exploit development, and post-exploitation.

**Key Arguments:**
- `target_url`: Target application URL
- `target_service`: Target service or application name
- `vulnerability_description`: Description of the zero-day vulnerability
- `exploit_file`: Path to zero-day exploit code

**MITRE ATT&CK:** T1190, T1195 (Supply Chain Compromise)

## TTP Structure

Each TTP includes the following components:

### 1. Metadata
- Unique UUID for tracking
- API Version 2.0 compliance
- Darwin (macOS) platform specification
- MITRE ATT&CK technique mapping

### 2. Arguments
Configurable parameters for customization:
- Target URLs and endpoints
- Payload paths and names
- Attack vectors and techniques
- Service specifications

### 3. Execution Steps
Sequential steps for attack execution:
- **Reconnaissance:** Gather target information
- **Preparation:** Create or prepare payloads
- **Exploitation:** Execute the attack
- **Verification:** Confirm success
- **Persistence:** Establish persistent access

### 4. Validation Checks
Verification procedures:
- Payload execution verification
- HTTP response validation
- Command output detection
- Status confirmation

### 5. Dry-Run Tests
Safe simulation mode:
- `dry_run: true` for test execution
- No actual exploitation
- Execution flow validation
- Safe testing capability

### 6. Cleanup Procedures
Post-exploitation cleanup:
- Artifact removal
- Shell cleanup
- Temporary file deletion
- Connection termination

## Usage

### Basic Usage
```bash
# Run a TTP with default parameters
ttpforge run 011-exploit-public-facing-app.yaml

# Run specific TTP with custom target
ttpforge run 013-sql-injection-test.yaml \
  --arg target_url="http://vulnerable-app.local" \
  --arg vulnerable_parameter="username"
```

### Dry-Run / Test Mode
```bash
# Test TTP execution without actual exploitation
ttpforge test 015-remote-code-execution.yaml

# Verify TTP structure
ttpforge parse-yaml 020-zero-day-exploitation.yaml
```

### Advanced Usage
```bash
# Run with logging
ttpforge run 012-web-shell-deployment.yaml \
  --logfile /tmp/ttp_test.log

# Verbose output
ttpforge run -v 018-xxe-injection.yaml
```

## Validation Results

All 10 TTPs have been validated and passed testing:

```
Total TTPs: 10
Passed: 10 (100%)
Failed: 0 (0%)

Validation Checks:
✓ YAML Syntax
✓ Required Fields
✓ Data Integrity
✓ Command Syntax
✓ Cleanup Procedures
```

## Security Considerations

### Authorization
- Obtain proper authorization before testing
- Document all testing activities
- Use in isolated lab environments only

### Mitigation
- Use TTPs to validate security controls
- Implement discovered mitigations
- Document findings and improvements

### Best Practices
1. Run in authorized testing environments
2. Document all activities
3. Monitor for unintended side effects
4. Clean up artifacts after testing
5. Analyze results for improvements

## MITRE ATT&CK Coverage

### Tactics
- **Initial Access:** T1190 (primary focus)
- **Persistence:** T1505
- **Execution:** T1059, T1651

### Techniques
- T1190: Exploit Public-Facing Application
- T1505: Traffic Signaling
- T1505.004: Web Shell
- T1195: Supply Chain Compromise
- T1598: Phishing

## File Directory Structure

```
/tmp/ttpforge-generated/initial_access/
├── 011-exploit-public-facing-app.yaml
├── 012-web-shell-deployment.yaml
├── 013-sql-injection-test.yaml
├── 014-cross-site-scripting.yaml
├── 015-remote-code-execution.yaml
├── 016-file-upload-vulnerability.yaml
├── 017-insecure-deserialization.yaml
├── 018-xxe-injection.yaml
├── 019-ssrf-attack.yaml
├── 020-zero-day-exploitation.yaml
├── README_WEB_EXPLOITATION.md (this file)
├── VALIDATION_REPORT.txt
└── [other TTPs from other categories]
```

## Additional Resources

### MITRE ATT&CK
- https://attack.mitre.org/tactics/TA0001/
- https://attack.mitre.org/techniques/T1190/

### Web Security
- OWASP Top 10
- CWE Top 25
- CVE Database

### Testing Tools
- Burp Suite
- OWASP ZAP
- SQLMap
- XSStrike
- Commix

## Support and Contributions

For issues, questions, or contributions:
1. Review the VALIDATION_REPORT.txt
2. Check TTP-specific arguments
3. Consult MITRE ATT&CK documentation
4. Test in isolated environments

## License

These TTPs are provided for authorized security testing and purple team exercises only.

---

**Report Generated:** 2026-01-30  
**Validation Status:** PASS (10/10)  
**Platform:** darwin (macOS)
