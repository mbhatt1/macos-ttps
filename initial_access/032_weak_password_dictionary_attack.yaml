uuid: 23b2f9d6-5a8c-4d4f-0b3c-2e7f0a0d4c6b
api_version: '2.0'
name: Weak Password Dictionary Attack
description: Perform dictionary attack against macOS accounts using common weak passwords
platform: darwin
category: initial_access
tactics:
  - valid_accounts
techniques:
  - T1078
severity: medium
author: Claude Code
created: 2026-01-30

args:
  target_account:
    description: Target account name for dictionary attack
    type: string
    required: true
  password_list:
    description: Path to dictionary file containing common passwords
    type: string
    required: true
  leaked_creds_file:
    description: Path to file with leaked credentials
    type: string
    required: false
  oauth_token:
    description: OAuth token for API authentication
    type: string
    required: false

steps:
  - name: load_dictionary
    description: Load password dictionary for attack
    command: |
      echo "Loading password dictionary from: ${password_list}"
      if [ -f "${password_list}" ]; then
        wc -l < "${password_list}" | xargs echo "Dictionary contains:"
      fi
      
  - name: dictionary_attack
    description: Attempt authentication with each dictionary password
    command: |
      echo "Starting dictionary attack against: ${target_account}"
      if [ -f "${password_list}" ]; then
        count=0
        while IFS= read -r password; do
          count=$((count + 1))
          # Dry run: simulate attempt
          [ $((count % 100)) -eq 0 ] && echo "Tested ${count} passwords"
        done < "${password_list}"
        echo "Completed dictionary attack with ${count} attempts"
      fi
      
  - name: check_successful_match
    description: Check if any password matched
    command: |
      echo "Analyzing authentication results"
      # Dry run simulation
      echo "Dictionary attack simulation completed"

checks:
  - name: verify_match_found
    description: Verify if a matching password was found
    command: |
      echo "Checking for successful password match"
      exit 0

tests:
  dry_run: true
  simulate_only: true

cleanup:
  - name: revoke_tokens
    description: Revoke any obtained OAuth tokens
    command: |
      echo "Revoking obtained tokens"
      
  - name: reset_passwords
    description: Reset compromised account passwords
    command: |
      echo "Resetting account passwords"
